#print_length 1000000
#print_depth 1000000

open Vabstraction
open VhdlTree
open VhdlMain
open Rewrite

let srclst = [
"AXI_ADDRESS_CONTROL_CHANNEL.vhd";
"AXI_master_transaction.vhd";
"AXI_READ_DATA_CHANNEL.vhd";
"AXI_WRITE_DATA_CHANNEL.vhd";
"AXI_WRITE_DATA_RESPONSE_CHANNEL.vhd";
];;

(*
let srclst = [ "junk.vhd" ];;

let srclst = [
"AXI_WRITE_DATA_CHANNEL.vhd"
]
*)

let lst = ref [];;

let convert srclst =
    let succ = ref true in
    main succ srclst;
    lst := [];
    Hashtbl.iter (fun (k,_) _ ->
        lst := abstraction(abstraction k) :: !lst) vhdlhash;
    dump !lst;;

let rslt = convert srclst;;
